---
title: "Data Summary"
author: "Jianhui Gao"
date: "18/02/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# UK Biobank Population

The data release contains genotypes of 488,377 UK Biobank participants, and 825,927 markers are genotyped.

## Quality control

The following QC steps are conducted

-   Exclude inviduals with \> 10% missing genotypes.

-   Exclude SNPs with maf \< 0.05

-   Include only SNPs with a 90% genotyping rate

-   Exclude markers that failure the Hardy-Weinberg test at 0.001

-   Include only White-British population ( Code 1001 in Data field 21000, self reported)

-   LD pruning. Window size = 50 SNPs, pairwise LD \> 0.5 is removed.

-   Exclude one member of each pair of samples with kinship coefficient greater than 0.117. (First degree relatives are removed)

After QC steps and removing individuals with missing age, sex, or phenotype height, 408207 samples and 211,587 genetic markers remained.

## Basic Association Model

Linear regression, adjusted for age, sex and 10 genetic PC, where the PCA is performed by FastPCA software as per standard.

## Height Prediction
In total, 25697 individuals were removed in the association analysis due to being first-degree relatives with other people. After excluding people with missing weight, 
```{r}
library(ggplot2)
load("/Users/jianhuigao/OneDrive - University of Toronto/EHR_research/SyntheticSurrogateAnalysis/Data/height_prediction.RData")
pheno <- data.frame(pheno)
cat("Total Number of Individuals:", nrow(pheno),"\n")
cat("Total Number of Male:", sum(pheno$sex==1),"\n")
cat("Total Number of Female:", sum(pheno$sex==0),"\n")
```

```{r}
par(mfrow=c(3,2))
for(i in c(2,4,5)){
  hist(pheno[, i], main = colnames(pheno)[i], xlab = "value")
  boxplot(pheno[, i], horizontal = T, ylab = colnames(pheno)[i])
}
```
